<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Take Exam | CBT System</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    /* General body styling for better centering and background */
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f4f7f6; /* Light grey background */
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      min-height: 100vh; /* Ensure full viewport height */
    }

    main {
      flex-grow: 1; /* Allows main content to take available space */
      display: flex;
      flex-direction: column;
      align-items: center; /* Center horizontally */
      justify-content: flex-start; /* Align content to the top */
      padding-top: 2rem; /* Add some space from the header */
      padding-bottom: 2rem;
    }

    /* Header Styling */
    header nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 2.5rem; /* Increased padding for more space */
      background-color: #007bff; /* Primary blue */
      color: white;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      flex-wrap: wrap; /* Allow wrapping on smaller screens */
    }

    .nav-links {
      list-style: none;
      margin: 0;
      padding: 0;
      display: flex;
      gap: 20px; /* Space between links */
      flex-wrap: wrap;
    }

    .nav-links a {
      color: white;
      text-decoration: none;
      font-weight: 500;
      padding: 5px 10px;
      border-radius: 5px;
      transition: background-color 0.2s ease;
    }

    .nav-links a:hover {
      background-color: rgba(255, 255, 255, 0.2);
    }

    .logo {
      font-size: 1.8rem; /* Larger logo */
      font-weight: 700;
      color: white;
    }

    /* Exam Container Styling */
    .exam-container {
      background-color: #ffffff;
      border-radius: 12px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.08);
      padding: 2.5rem; /* Increased padding */
      width: 100%;
      max-width: 850px; /* Max width for content */
      margin-top: 2rem;
      border: 1px solid #e0e0e0;
    }

    .exam-header {
      text-align: center;
      margin-bottom: 2rem;
      border-bottom: 1px solid #eee;
      padding-bottom: 1.5rem;
    }

    .exam-header h1 {
      color: var(--primary-blue);
      font-size: 2.2rem;
      margin-bottom: 0.5rem;
    }

    .exam-header p {
      color: var(--text-medium);
      font-size: 1.1em;
      margin: 0.3em 0;
    }

    .question-navigation {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 2rem;
      justify-content: center;
      padding: 1rem 0;
      border-bottom: 1px solid #eee;
    }

    .question-nav-btn {
      background-color: #e9ecef;
      border: 1px solid #ced4da;
      padding: 8px 12px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.2s ease;
    }

    .question-nav-btn:hover:not(.active) {
      background-color: #d1d8df;
    }

    .question-nav-btn.active {
      background-color: var(--primary-blue);
      color: white;
      border-color: var(--primary-blue);
    }
    /* Style for answered questions */
    .question-nav-btn.answered {
        background-color: #d4edda; /* Light green */
        border-color: #28a745; /* Green border */
        color: #28a745;
    }
    .question-nav-btn.answered.active {
        background-color: #28a745; /* Darker green when active and answered */
        color: white;
    }


    .question-card {
      background-color: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 10px;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: 0 2px 10px rgba(0,0,0,0.03);
    }

    .question-card h3 {
      color: var(--text-dark);
      margin-top: 0;
      margin-bottom: 1.5rem;
      font-size: 1.4em;
    }

    .options-list {
      list-style: none;
      padding: 0;
    }

    .options-list li {
      margin-bottom: 1rem;
    }

    .options-list label {
      display: flex;
      align-items: center;
      padding: 12px 15px;
      border: 1px solid #ced4da;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      background-color: #fff;
    }

    .options-list label:hover {
      background-color: #e9f0f6;
      border-color: var(--primary-blue);
    }

    .options-list input[type="radio"] {
      margin-right: 15px;
      transform: scale(1.2); /* Slightly larger radio buttons */
    }

    .timer-display {
      font-size: 1.5em;
      font-weight: 700;
      color: var(--primary-blue);
      text-align: center;
      margin-bottom: 1.5rem;
      background-color: #eaf3ff;
      padding: 10px 20px;
      border-radius: 8px;
      border: 1px solid #cce0ff;
    }
    .timer-display.warning {
        color: var(--danger-red);
        background-color: #ffebeb;
        border-color: #f5c6cb;
    }


    .exam-actions-bottom {
      display: flex;
      justify-content: space-between;
      margin-top: 2rem;
    }

    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: var(--border-radius-sm);
      cursor: pointer;
      font-size: 1em;
      transition: background-color 0.2s ease;
    }

    .btn-primary {
      background-color: var(--primary-blue);
      color: white;
    }

    .btn-primary:hover {
      background-color: #0056b3;
    }

    .btn-secondary {
      background-color: #6c757d;
      color: white;
    }

    .btn-secondary:hover {
      background-color: #5a6268;
    }

    .btn:disabled {
        background-color: #cccccc;
        cursor: not-allowed;
    }

    #examMessage {
        padding: 15px;
        margin-bottom: 20px;
        border-radius: 8px;
        text-align: center;
        font-weight: 500;
    }
    #examMessage.info {
        background-color: #e0f7fa;
        color: #00796b;
        border: 1px solid #00796b;
    }
    #examMessage.error {
        background-color: #ffebee;
        color: #d32f2f;
        border: 1px solid #d32f2f;
    }
    /* Section instructions styling */
    .section-instructions-display {
        background-color: #f0f8ff;
        border-left: 5px solid #007bff;
        padding: 15px;
        margin-bottom: 1.5rem;
        border-radius: 5px;
        font-style: italic;
        color: #333;
    }

    footer {
      margin-top: auto; /* Pushes footer to the bottom */
      padding: 1.5rem;
      background-color: #343a40;
      color: white;
      text-align: center;
      width: 100%;
    }

    /* Modals for alerts and confirmations */
    .modal {
        display: none; /* Hidden by default */
        position: fixed; /* Stay in place */
        z-index: 1000; /* Sit on top */
        left: 0;
        top: 0;
        width: 100%; /* Full width */
        height: 100%; /* Full height */
        overflow: auto; /* Enable scroll if needed */
        background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
        display: flex; /* Use flexbox for centering */
        align-items: center; /* Center vertically */
        justify-content: center; /* Center horizontally */
    }
    .modal-content {
        background-color: #fefefe;
        margin: auto;
        padding: 0;
        border: 1px solid #888;
        width: 80%; /* Could be responsive */
        max-width: 500px;
        border-radius: 10px; /* Rounded corners */
        box-shadow: 0 8px 30px rgba(0,0,0,0.25);
        overflow: hidden; /* Ensures rounded corners on content */
    }
    .modal-header {
        padding: 15px 20px;
        background-color: var(--primary-blue);
        color: white;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-radius: 10px 10px 0 0;
    }
    .modal-header h2 {
        margin: 0;
        font-size: 1.2rem;
    }
    .modal-body {
        padding: 20px;
        text-align: center;
    }
    .modal-footer {
        padding: 15px 20px;
        background-color: #f1f1f1;
        text-align: right;
        border-top: 1px solid #e0e0e0;
        border-radius: 0 0 10px 10px;
    }
    .close-button {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
        transition: color 0.3s ease;
    }
    .close-button:hover,
    .close-button:focus {
        color: #ddd;
        text-decoration: none;
        cursor: pointer;
    }
  </style>
</head>
<body>
  <header>
    <nav>
      <div class="logo">CBT System</div>
      <ul class="nav-links">
        <li><a href="dashboard.html" class="nav-link">Dashboard</a></li>
        <li><a href="#" id="logoutLink" class="nav-link">Logout</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <div class="exam-container">
        <div id="examMessage" class="hidden"></div>
        <div id="loadingIndicator" style="text-align: center; padding: 20px;">Loading exam...</div>
        
        <div id="examContent" class="hidden">
            <div class="exam-header">
                <h1 id="examTitle"></h1>
                <p>Subject: <span id="examSubject"></span></p>
                <p>Total Questions: <span id="totalQuestions"></span></p>
                <p>Duration: <span id="examDuration"></span> minutes</p>
                <p id="examInstructions"></p>
            </div>

            <div id="timerDisplay" class="timer-display"></div>

            <div id="questionNavigation" class="question-navigation">
                </div>

            <div id="sectionsContainer">
                <!-- Sections and questions will be rendered here -->
            </div>

            <div class="exam-actions-bottom">
                <button id="prevQuestionBtn" class="btn btn-secondary">Previous</button>
                <button id="nextQuestionBtn" class="btn btn-primary">Next</button>
                <button id="submitExamBtn" class="btn btn-primary hidden">Submit Exam</button>
            </div>
        </div>
    </div>
  </main>

  <footer>
    <p>&copy; 2025 CBT System</p>
  </footer>

  <script>
    let currentExam = null;
    let userAnswers = {}; // Stores answers: { questionId: selectedOptionId }
    let allQuestions = []; // Flattened list of all questions for easy indexing
    let currentQuestionIndex = 0;
    let timerInterval;
    let timeRemaining; // in seconds
    let examStartTime; // To track when the exam actually started for timeTakenSeconds calculation

    // Modals for alerts and confirmations
    let currentConfirmationCallback = null; 

    function showConfirmation(message) {
        return new Promise(resolve => {
            document.getElementById('confirmationMessage').textContent = message;
            document.getElementById('confirmationModal').style.display = 'flex'; 
            currentConfirmationCallback = resolve;
        });
    }

    function confirmAction(result) {
        if (currentConfirmationCallback) {
            currentConfirmationCallback(result);
            currentConfirmationCallback = null; 
        }
        closeModal('confirmationModal');
    }

    function showAlert(message, title = "Alert") {
        document.getElementById('alertTitle').textContent = title;
        document.getElementById('alertMessage').textContent = message;
        document.getElementById('alertDialog').style.display = 'flex'; 
    }

    function closeModal(modalId) {
        document.getElementById(modalId).style.display = 'none';
    }
    // End Modals

    const examMessageElement = document.getElementById('examMessage');
    const loadingIndicator = document.getElementById('loadingIndicator');
    const examContent = document.getElementById('examContent');
    const examTitle = document.getElementById('examTitle');
    const examSubject = document.getElementById('examSubject');
    const totalQuestionsDisplay = document.getElementById('totalQuestions'); // Renamed to avoid conflict
    const examDurationDisplay = document.getElementById('examDuration');     // Renamed to avoid conflict
    const examInstructionsDisplay = document.getElementById('examInstructions'); // New element for instructions
    const timerDisplay = document.getElementById('timerDisplay');
    const questionNavigation = document.getElementById('questionNavigation');
    const sectionsContainer = document.getElementById('sectionsContainer'); // Main container for sections
    const prevQuestionBtn = document.getElementById('prevQuestionBtn');
    const nextQuestionBtn = document.getElementById('nextQuestionBtn');
    const submitExamBtn = document.getElementById('submitExamBtn');

    function displayMessage(type, message) {
        examMessageElement.textContent = message;
        examMessageElement.className = `exam-message ${type}`;
        examMessageElement.classList.remove('hidden');
        setTimeout(() => {
            examMessageElement.classList.add('hidden');
        }, 5000);
    }

    async function loadUserData() {
        try {
            const response = await fetch('/api/users/me', { credentials: 'include' });
            if (!response.ok) {
                // If not authenticated, redirect to login
                window.location.href = '/login.html';
                return null;
            }
            const user = await response.json();
            // Assuming you have a navUsername element in your layout
            // document.getElementById('navUsername').textContent = user.username; // This element might not exist
            // createNavigationLinks(user); // If you have this function for dynamic nav
            return user;
        } catch (error) {
            console.error("Error loading user data:", error);
            // If there's a network error or other issue, also redirect
            window.location.href = '/login.html';
            return null;
        }
    }


    async function loadExam() {
        loadingIndicator.classList.remove('hidden');
        examContent.classList.add('hidden');
        examMessageElement.classList.add('hidden');

        const urlParams = new URLSearchParams(window.location.search);
        const examId = urlParams.get('examId');

        if (!examId) {
            displayMessage('error', 'No exam ID provided.');
            loadingIndicator.classList.add('hidden');
            return;
        }

        try {
            // Start exam session first to get exam details and potentially resume data
            const startSessionResponse = await fetch(`/api/exam-sessions/${examId}/start`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                credentials: 'include'
            });

            if (!startSessionResponse.ok) {
                // Attempt to read as JSON first, but if that fails, read as text.
                let errorData;
                let errorMessage = 'Failed to start exam session.';
                try {
                    errorData = await startSessionResponse.json();
                    errorMessage = errorData.error || errorMessage;
                } catch (jsonError) {
                    // If response is not JSON (e.g., HTML error page), read as text
                    const textResponse = await startSessionResponse.text();
                    errorMessage = `Server responded with non-JSON: ${textResponse.substring(0, 100)}... (Status: ${startSessionResponse.status})`;
                }
                throw new Error(errorMessage);
            }
            const sessionData = await startSessionResponse.json();
            
            currentExam = sessionData.exam;
            // Flatten all questions from sections for easier indexing
            allQuestions = [];
            sessionData.sections.forEach(section => {
                section.questions.forEach(q => {
                    allQuestions.push({ ...q, section_id: section.section_id, section_name: section.section_name, section_instructions: section.section_instructions });
                });
            });

            // Initialize user answers from session progress if available
            if (sessionData.session && sessionData.session.progress) {
                // Safely parse the progress string back into an object if it's a string
                // If it's already an object (due to database driver parsing JSONB), use it directly
                if (typeof sessionData.session.progress === 'string') {
                    try {
                        userAnswers = JSON.parse(sessionData.session.progress);
                    } catch (e) {
                        console.error("Error parsing saved progress JSON:", e);
                        userAnswers = {}; // Reset if parsing fails
                    }
                } else if (typeof sessionData.session.progress === 'object' && sessionData.session.progress !== null) {
                    userAnswers = sessionData.session.progress;
                } else {
                    userAnswers = {}; // Default to empty object if progress is null or unexpected type
                }
            } else {
                allQuestions.forEach(q => {
                    userAnswers[q.question_id] = null; // Initialize with null if no progress
                });
            }

            examTitle.textContent = currentExam.title;
            examSubject.textContent = currentExam.subject_name;
            totalQuestionsDisplay.textContent = allQuestions.length;
            examDurationDisplay.textContent = currentExam.duration_minutes;
            examInstructionsDisplay.textContent = currentExam.exam_instructions || 'No general instructions provided.';

            renderQuestionNavigation();
            showQuestion(0); // Show the first question
            
            // Resume timer from saved time or start new
            timeRemaining = sessionData.session.timeRemaining || (currentExam.duration_minutes * 60);
            // Ensure examStartTime is calculated correctly for resuming sessions
            examStartTime = Date.now() - (currentExam.duration_minutes * 60 - timeRemaining) * 1000; 
            startTimer(timeRemaining);

            // Set up auto-save every 30 seconds
            setInterval(saveProgress, 30000); // Save every 30 seconds

            loadingIndicator.classList.add('hidden');
            examContent.classList.remove('hidden');

        } catch (error) {
            displayMessage('error', `Error loading exam: ${error.message}. Please try again or contact support.`);
            loadingIndicator.classList.add('hidden');
            console.error("Load exam error:", error);
        }
    }

    function renderQuestionNavigation() {
        questionNavigation.innerHTML = '';
        allQuestions.forEach((q, index) => {
            const button = document.createElement('button');
            button.classList.add('question-nav-btn');
            button.textContent = index + 1;
            button.dataset.questionId = q.question_id; // Store question ID
            button.addEventListener('click', () => showQuestion(index));
            
            // Mark as answered if an answer exists
            if (userAnswers[q.question_id] !== null && userAnswers[q.question_id] !== undefined) {
                button.classList.add('answered');
            }
            questionNavigation.appendChild(button);
        });
    }

    function showQuestion(index) {
        if (!currentExam || !allQuestions || index < 0 || index >= allQuestions.length) {
            return;
        }

        currentQuestionIndex = index;
        const question = allQuestions[currentQuestionIndex];
        sectionsContainer.innerHTML = ''; // Clear previous content

        // Display section title and instructions if applicable
        const sectionCard = document.createElement('div');
        sectionCard.classList.add('section-card-display'); // You might need to define this style
        sectionCard.innerHTML = `
            <h2>${question.section_name}</h2>
            ${question.section_instructions ? `<p class="section-instructions-display">${question.section_instructions}</p>` : ''}
        `;
        sectionsContainer.appendChild(sectionCard);


        const questionCard = document.createElement('div');
        questionCard.classList.add('question-card');
        questionCard.innerHTML = `
            <h3>Question ${currentQuestionIndex + 1} of ${allQuestions.length}:</h3>
            <p>${question.question_text}</p>
            <ul class="options-list" id="optionsList-${question.question_id}">
                ${question.options.map(option => `
                    <li>
                        <label>
                            <input type="radio" name="question-${question.question_id}" value="${option.id}"
                                ${userAnswers[question.question_id] === option.id ? 'checked' : ''}>
                            ${option.text}
                        </label>
                    </li>
                `).join('')}
            </ul>
        `;
        sectionsContainer.appendChild(questionCard);

        // Add event listener for option changes
        const optionsList = document.getElementById(`optionsList-${question.question_id}`);
        optionsList.addEventListener('change', (event) => {
            if (event.target.type === 'radio') {
                userAnswers[question.question_id] = event.target.value; // Store the selected option ID (A, B, C, D)
                updateQuestionNavButton(currentQuestionIndex, true); // Mark as answered
            }
        });

        // Update navigation buttons styling
        document.querySelectorAll('.question-nav-btn').forEach((btn, idx) => {
            btn.classList.remove('active');
            if (idx === currentQuestionIndex) {
                btn.classList.add('active');
            }
        });

        // Update Prev/Next/Submit buttons
        prevQuestionBtn.disabled = currentQuestionIndex === 0;
        nextQuestionBtn.disabled = currentQuestionIndex === allQuestions.length - 1;

        if (currentQuestionIndex === allQuestions.length - 1) {
            submitExamBtn.classList.remove('hidden');
            nextQuestionBtn.classList.add('hidden'); // Hide next button on last question
        } else {
            submitExamBtn.classList.add('hidden');
            nextQuestionBtn.classList.remove('hidden');
        }
    }

    function updateQuestionNavButton(index, answered) {
        const button = questionNavigation.children[index];
        if (button) {
            if (answered) {
                button.classList.add('answered'); // Add a class for answered questions
            } else {
                button.classList.remove('answered');
            }
        }
    }

    prevQuestionBtn.addEventListener('click', () => {
        if (currentQuestionIndex > 0) {
            showQuestion(currentQuestionIndex - 1);
        }
    });

    nextQuestionBtn.addEventListener('click', () => {
        if (currentQuestionIndex < allQuestions.length - 1) {
            showQuestion(currentQuestionIndex + 1);
        }
    });

    submitExamBtn.addEventListener('click', async () => {
        const confirmed = await showConfirmation('Are you sure you want to submit the exam? You cannot change answers after submission.');
        if (confirmed) {
            await submitExam();
        }
    });

    function startTimer(durationInSeconds) {
        timeRemaining = durationInSeconds;
        updateTimerDisplay(); // Initial display

        timerInterval = setInterval(() => {
            timeRemaining--;
            updateTimerDisplay();

            if (timeRemaining <= 300 && !timerDisplay.classList.contains('warning')) { // 5 minutes warning
                timerDisplay.classList.add('warning');
            }

            if (timeRemaining <= 0) {
                clearInterval(timerInterval);
                displayMessage('info', 'Time is up! Submitting your exam automatically.');
                submitExam(); // Auto-submit when time runs out
            }
        }, 1000);
    }

    function updateTimerDisplay() {
        const minutes = Math.floor(timeRemaining / 60);
        const seconds = timeRemaining % 60;
        timerDisplay.textContent = `Time Left: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    }

    async function saveProgress() {
        if (!currentExam || Object.keys(userAnswers).length === 0) {
            return; // Don't save if exam not loaded or no answers
        }
        try {
            const response = await fetch(`/api/exam-sessions/${currentExam.exam_id}/progress`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                credentials: 'include',
                body: JSON.stringify({
                    answers: userAnswers,
                    timeRemaining: timeRemaining
                }),
            });
            if (!response.ok) {
                console.warn('Failed to auto-save progress:', await response.json());
            } else {
                console.log('Progress auto-saved.');
            }
        } catch (error) {
            console.error('Error during auto-save:', error);
        }
    }

    async function submitExam() {
        clearInterval(timerInterval); // Stop the timer
        submitExamBtn.disabled = true;
        submitExamBtn.textContent = 'Submitting...';

        const timeTakenSeconds = Math.floor((Date.now() - examStartTime) / 1000);

        // Ensure userAnswers is an object with questionId as keys and selectedOptionId as values
        // The backend expects answers as { "questionId": "selectedOptionId" }
        const submissionAnswers = {};
        allQuestions.forEach(q => {
            if (userAnswers[q.question_id]) {
                submissionAnswers[q.question_id] = userAnswers[q.question_id];
            }
        });


        try {
            const response = await fetch(`/api/exam-sessions/${currentExam.exam_id}/submit`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    answers: submissionAnswers,
                    timeTakenSeconds: timeTakenSeconds
                }),
                credentials: 'include'
            });

            const result = await response.json();

            if (!response.ok) {
                throw new Error(result.error || 'Unknown error occurred.');
            }

            if (result.examType === 'MAIN_EXAM') { // Assuming MAIN_EXAM means no immediate score display
                displayMessage('info', `Exam submitted successfully! You will be redirected to the dashboard shortly.`);
                setTimeout(() => window.location.href = 'dashboard.html', 3000);
            } else {
                displayMessage('success', `Test submitted successfully! Your score is ${result.score.toFixed(1)}%. Redirecting to results...`);
                setTimeout(() => window.location.href = `results.html?resultId=${result.resultId}`, 3000);
            }

        } catch (error) {
            if(submitExamBtn) { // Re-enable button on failure to allow retry
               submitExamBtn.disabled = false;
               submitExamBtn.textContent = 'Submit Exam';
            }
            displayMessage('error', `Could not submit exam: ${error.message}. Please check your connection and try again.`);
        }
    }

    document.getElementById('logoutLink').addEventListener('click', async (e) => {
        e.preventDefault();
        try {
            await fetch(`/api/users/logout`, { method: 'POST', credentials: 'include' });
        } catch(err) {
            console.error("Logout failed:", err);
        } finally {
            window.location.href = '/login.html';
        }
    });

    window.addEventListener('DOMContentLoaded', async () => {
        const user = await loadUserData(); // This will redirect if not authenticated
        if (user) {
            loadExam();
        }
    });
  </script>
  <!-- Modals HTML (add these to the end of your body tag) -->
<div id="confirmationModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Confirm Action</h2>
            <span class="close-button" onclick="closeModal('confirmationModal')">&times;</span>
        </div>
        <div class="modal-body">
            <p id="confirmationMessage"></p>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" onclick="confirmAction(false)">Cancel</button>
            <button class="btn btn-primary" onclick="confirmAction(true)">Confirm</button>
        </div>
    </div>
</div>

<div id="alertDialog" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="alertTitle">Alert</h2>
            <span class="close-button" onclick="closeModal('alertDialog')">&times;</span>
        </div>
        <div class="modal-body">
            <p id="alertMessage"></p>
        </div>
        <div class="modal-footer">
            <button class="btn btn-primary" onclick="closeModal('alertDialog')">OK</button>
        </div>
    </div>
</div>
</body>
</html>
